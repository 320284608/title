import requests
import time

# 配置参数（包含所有需要转换的内容）
DATA = [
    "学，学习的学",
"习，学习的习",
"好，好人的好",
"人，好人的人",
"大，大小的大",
"小，大小的小",
"上，上下的上",
"下，上下的下",
"中，中国的中",
"国，中国的国",
"天，天地的天",
"地，天地的地",
"日，日月的日",
"月，日月的月",
"水，水火的水",
"火，水火的火",
"山，山水的山",
"木，树木的木",
"口，人口的口",
"手，双手的手",
"心，开心的心",
"目，耳目口鼻的目",
"耳，耳目口鼻的耳",
"鼻，耳目口鼻的鼻",
"家，家庭的家",
"书，书本的书",
"车，汽车的车",
"门，家门的门",
"鱼，小鱼的鱼",
"鸟，小鸟的鸟",
"虫，虫子的虫",
"马，小马的马",
"牛，小牛的牛",
"羊，小羊的羊",
"猫，小猫的猫",
"狗，小狗的狗",
"兔，兔子的兔",
"龙，中国龙的龙",
"花，花朵的花",
"草，青草的草",
"树，树木的树",
"米，大米的米",
"面，面条的面",
"菜，蔬菜的菜",
"果，水果的果",
"茶，茶叶的茶",
"水，喝水的水",
"风，风雨的风",
"雨，风雨的雨",
"雪，雪花的雪",
"云，云朵的云",
"电，闪电的电",
"路，道路的路",
"桥，桥梁的桥",
"海，大海的海",
"河，河流的河",
"湖，湖泊的湖",
"江，长江的江",
"城，城市的城",
"爸，爸爸的爸",
"妈，妈妈的妈",
"爷，爷爷的爷",
"奶，奶奶的奶",
"哥，哥哥的哥",
"姐，姐姐的姐",
"弟，弟弟的弟",
"妹，妹妹的妹",
"桌，桌子的桌",
"椅，椅子的椅",
"床，睡觉的床",
"被，被子的被",
"枕，枕头的枕",
"灯，电灯的灯",
"笔，铅笔的笔",
"纸，白纸的纸",
"本，书本的本",
"刀，小刀的刀",
"尺，尺子的尺",
"球，皮球的球",
"拍，球拍的拍",
"绳，跳绳的绳",
"钟，闹钟的钟",
"表，手表的表",
"伞，雨伞的伞",
"帽，帽子的帽",
"衣，衣服的衣",
"裤，裤子的裤",
"鞋，鞋子的鞋",
"袜，袜子的袜",
"锅，铁锅的锅",
"碗，饭碗的碗",
"筷，筷子的筷",
"勺，勺子的勺",
"叉，叉子的叉",
"瓶，瓶子的瓶",
"杯，杯子的杯",
"盘，盘子的盘",
"盆，水盆的盆",
"桶，水桶的桶",
"袋，袋子的袋",
"包，书包的包",
"箱，箱子的箱",
"锁，门锁的锁",
"钥，钥匙的钥",
"钉，钉子的钉",
"锤，锤子的锤",
"斧，斧头的斧",
"锯，锯子的锯",
"锄，锄头的锄",
"镰，镰刀的镰",
"梯，梯子的梯",
"凳，凳子的凳",
"梯，楼梯的梯",
"扇，扇子的扇",
"镜，镜子的镜",
"梳，梳子的梳",
"刷，牙刷的刷",
"皂，肥皂的皂",
"香，香皂的香",
"油，加油的油",
"盐，食盐的盐",
"糖，白糖的糖",
"酱，酱油的酱",
"醋，白醋的醋",
"奶，牛奶的奶",
"蛋，鸡蛋的蛋",
"豆，黄豆的豆",
"瓜，西瓜的瓜",
"茄，茄子的茄",
"椒，辣椒的椒",
"葱，大葱的葱",
"姜，生姜的姜",
"蒜，大蒜的蒜",
"药，吃药的药",
"针，打针的针",
"线，针线的线",
"布，棉布的布",
"毛，羊毛的毛",
"皮，牛皮的皮",
"石，石头的石",
"沙，沙子的沙",
"土，土地的土",
"泥，泥巴的泥",
"灰，灰尘的灰",
"烟，香烟的烟",
"雾，大雾的雾",
"冰，冰块的冰",
"霜，霜花的霜",
"星，星星的星",
"辰，星辰的辰",
"光，阳光的光",
"明，明天的明",
"暗，黑暗的暗",
"黑，黑色的黑",
"白，白色的白",
"红，红色的红",
"绿，绿色的绿",
"黄，黄色的黄",
"蓝，蓝色的蓝",
"紫，紫色的紫",
"橙，橙色的橙",
"粉，粉色的粉",
"棕，棕色的棕",
"灰，灰色的灰",
"金，金色的金",
"银，银色的银",
"学习，学习知识的学习",
"工作，努力工作的工作",
"生活，美好生活的生活",
"朋友，好朋友的朋友",
"家人，家人团聚的家人",
"老师，老师授课的老师",
"学生，学生上课的学生",
"医生，医生治病的医生",
"警察，警察抓坏人的警察",
"司机，司机开车的司机",
"商店，去商店购物的商店",
"公园，逛公园的公园",
"学校，在学校上学的学校",
"医院，生病去医院的医院",
"银行，去银行存钱的银行",
"餐厅，在餐厅吃饭的餐厅",
"电影，看电影的电影",
"音乐，听音乐的音乐",
"运动，做运动的运动",
"游戏，玩游戏的游戏",
"电脑，用电脑办公的电脑",
"手机，用手机打电话的手机",
"电视，看电视的电视",
"汽车，坐汽车出行的汽车",
"飞机，坐飞机去旅行的飞机",
"火车，坐火车出差的火车",
"地铁，坐地铁上班的地铁",
"公交，坐公交回家的公交",
"早餐，吃早餐的早餐",
"午餐，吃午餐的午餐",
"晚餐，吃晚餐的晚餐",
"水果，吃水果的水果",
"蔬菜，吃蔬菜的蔬菜",
"肉类，吃肉类的肉类",
"海鲜，吃海鲜的海鲜",
"甜点，吃甜点的甜点",
"饮料，喝饮料的饮料",
"咖啡，喝咖啡的咖啡",
"茶叶，泡茶叶的茶叶",
"天气，今天的天气",
"季节，不同的季节",
"春天，春天来了的春天",
"夏天，夏天炎热的夏天",
"秋天，秋天丰收的秋天",
"冬天，冬天寒冷的冬天",
"节日，庆祝节日的节日",
"生日，过生日的生日",
"新年，过新年的新年",
"中秋，中秋节团圆的中秋",
"国庆，国庆节的国庆",
"一举两得，做事能一举两得的一举两得",
"四面八方，来自四面八方的四面八方",
"五颜六色，五颜六色的花朵的五颜六色",
"七上八下，心里七上八下的七上八下",
"九牛一毛，这只是九牛一毛的九牛一毛",
"十全十美，力求十全十美的十全十美",
"百发百中，射箭百发百中的百发百中",
"千变万化，世界千变万化的千变万化",
"万紫千红，万紫千红的春天的万紫千红",
"三心二意，做事不能三心二意的三心二意",
"半信半疑，对这件事半信半疑的半信半疑",
"自言自语，他总是自言自语的自言自语",
"自作自受，这是他自作自受的自作自受",
"前因后果，了解事情的前因后果的前因后果",
"东张西望，他在东张西望的东张西望",
"南辕北辙，方向南辕北辙的南辕北辙",
"左思右想，左思右想后做决定的左思右想",
"有始有终，做事要有始有终的有始有终",
"无影无踪，他消失得无影无踪的无影无踪",
"天长地久，愿爱情天长地久的天长地久",
"行，行走的行",
"乐，快乐乐的乐",
"长，长短的长",
"得，得到的得",
"好，好的的好",
"大，大大的大",
"觉，睡觉的觉",
"着，看着的着",
"重，重量的重",
"为，因为的为",
"省，省份的省",
"还，还有的还",
"地，土地的地",
"弹，弹琴的弹",
"数，数学的数",
"空，天空的空",
"和，和平的和",
"调，调节的调",
"少，多少的少",
"只，一只的只",
"系，关系的系",
"假，真假的假",
"难，困难的难",
"量，数量的量",
"发，头发的发",
"折，折纸的折",
"奇，奇怪的奇",
"间，中间的间",
"解，解决的解",
"分，分开的分",
"龘，龙行龘龘的龘",
"鬻，卖官鬻爵的鬻",
"鑫，金鑫的鑫",
"麤，粗的异体字麤",
"齉，鼻腻齉的齉",
"鸯，鸳鸯的鸯",
"鬣，马鬣的鬣",
"鱻，古同“鲜”的鱻",
"鬟，发髻的鬟",
"鸾，鸾凤的鸾" 
]

HEADERS = {
    'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 18_2_1 like Mac OS X) AppleWebKit/537.36 (KHTML, like Gecko) Version/18.2 Mobile/15E148 Safari/537.36',
    'Referer': 'https://t.leftsite.cn/'
}

BASE_URL = 'https://t.leftsite.cn/tts'
REQUEST_INTERVAL = 3  # 安全请求间隔
TIMEOUT = 15

def generate_filename(text):
    """生成纯中文文件名（示例：学.mp3）"""
    # 提取第一个汉字
    return f"{text.split('，')[0].strip()}.mp3"

def download_with_curl_format(text):
    """完全模拟curl请求格式"""
    try:
        # 构造与curl完全一致的参数
        params = {
            't': text,          # 保留完整文本
            'v': 'zh-CN-XiaoxiaoNeural',
            'r': 0,            # 与curl示例一致的参数
            'p': 0
        }
        
        # 生成文件名
        filename = generate_filename(text)
        
        print(f"正在请求：{text}")

        # 发送请求（关闭自动编码）
        response = requests.request(
            'GET',
            BASE_URL,
            params=params,
            headers=HEADERS,
            timeout=TIMEOUT
        )

        # 调试输出
        print(f"实际请求URL:\n{response.url}\n")

        # 验证响应
        if response.status_code == 200:
            if 'audio/mpeg' in response.headers.get('Content-Type', ''):
                with open(filename, 'wb') as f:
                    f.write(response.content)
                print(f"✅ 成功保存：{filename}")
                return True
            else:
                print(f"❌ 无效内容类型：{response.headers.get('Content-Type')}")
        else:
            print(f"❌ 请求失败 HTTP {response.status_code}")

    except Exception as e:
        print(f"⚠️ 下载失败：{str(e)}")
    
    return False

def main():
    """批量下载主程序"""
    total = len(DATA)
    success = 0
    
    for index, text in enumerate(DATA, 1):
        print(f"\n进度 ({index}/{total})")
        if download_with_curl_format(text):
            success += 1
        time.sleep(REQUEST_INTERVAL)
    
    print(f"\n下载完成！成功 {success}/{total} 个文件")

if __name__ == "__main__":
    main()